{
  "hash": "6febdd8552611d7a168f8fa1d436d94e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exploratory Data Analysis\"\nauthor: \"Your Name\"\ndate: today\nformat:\n  html:\n    code-fold: true\n    toc: true\n    theme: cosmo\n---\n\n## Load Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(knitr)\n```\n:::\n\n\n## Load Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake <- readRDS(\"../data/processed/earthquake_clean.rds\")\ncat(\"✓ Successfully loaded\", nrow(earthquake), \"earthquake observations\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Successfully loaded 142083 earthquake observations\n```\n\n\n:::\n:::\n\n\n---\n\n# Magnitude Distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(earthquake, aes(x = Magnitude)) +\n  geom_histogram(binwidth = 0.5, fill = \"steelblue\", color = \"black\", alpha = 0.7) +\n  geom_vline(aes(xintercept = mean(Magnitude, na.rm = TRUE)), \n             color = \"red\", linetype = \"dashed\", linewidth = 1) +\n  labs(\n    title = \"Magnitude Distribution\",\n    x = \"Magnitude (Richter Scale)\",\n    y = \"Frequency\",\n    caption = paste(\"Mean =\", round(mean(earthquake$Magnitude, na.rm = TRUE), 2))\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\", size = 14))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 6463 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Histogram of earthquake magnitudes](03-exploratory_files/figure-html/fig-magnitude-1.png){#fig-magnitude width=960}\n:::\n:::\n\n\n**Summary:**\n- Mean magnitude: 7.41\n- Range: 4 to 11\n- Most data concentrated around magnitude 8\n\n---\n\n# Recording Locations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake %>%\n  count(Location, sort = TRUE) %>%\n  head(10) %>%\n  ggplot(aes(x = reorder(Location, n), y = n)) +\n  geom_col(fill = \"steelblue\", alpha = 0.7) +\n  geom_text(aes(label = n), hjust = -0.3, size = 4) +\n  labs(\n    title = \"Top 10 Recording Locations\",\n    x = \"Location\",\n    y = \"Count\"\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\", size = 14)) +\n  coord_flip() +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.1)))\n```\n\n::: {.cell-output-display}\n![Top 10 recording locations](03-exploratory_files/figure-html/fig-locations-1.png){#fig-locations width=960}\n:::\n:::\n\n\n**Summary:**\n- Total stations: 19416\n- States: CA, WY, CO, AK, WA, NV, IN, SC, GA, NY, MO, TN, MS, KY, IL, AR, NC, TX, MD, ME, NB, QC, NS, CT, OR, UT, SD, MA, RI, ON, AL, BC, MXBC, AZ, OH, IA, VA, DC, KS, NH, PA, DE, WV, FL, VT, HI, OK, NM, MI, WI, NJ, MT, NE, ID, LA, PR, VI, ND, MXSO, YT, NA, MXME, MN, SK, AB, MB, NL\n- Observations spread across CA, NV, and other states\n\n---\n\n# Distance vs Intensity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nintensity_summary <- earthquake %>%\n  filter(!is.na(Intensity)) %>%\n  group_by(Distance_Category) %>%\n  summarise(\n    Mean_Intensity = mean(Intensity, na.rm = TRUE), \n    Count = n(),\n    .groups = \"drop\"\n  ) %>%\n  mutate(Distance_Category = factor(Distance_Category, \n                                     levels = c(\"Near\", \"Medium\", \"Far\", \"Very Far\")))\n\nggplot(intensity_summary, aes(x = Distance_Category, y = Mean_Intensity)) +\n  geom_col(fill = \"steelblue\", alpha = 0.7) +\n  geom_text(aes(label = paste0(round(Mean_Intensity, 2), \"\\n(n=\", Count, \")\")), \n            vjust = -0.5, size = 3.5) +\n  labs(\n    title = \"Average Intensity by Distance\",\n    x = \"Distance from Epicenter\",\n    y = \"Mean Intensity\"\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\", size = 14)) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))\n```\n\n::: {.cell-output-display}\n![Average intensity decreases with distance](03-exploratory_files/figure-html/fig-distance-intensity-1.png){#fig-distance-intensity width=960}\n:::\n:::\n\n\n**Summary:**\n- Near (<50 km): intensity 5-7\n- Medium (50-100 km): intensity 4-6\n- Far (100-150 km): intensity 3-4\n- Very Far (>150 km): intensity 2-3\n- Clear pattern: intensity decreases with distance (seismic attenuation)\n\n---\n\n# Understanding the Distance-Intensity Relationship\n\n## Magnitude by Distance Category\n\nWhy does \"Far\" sometimes show higher intensity than \"Near\"? Let's investigate by looking at what magnitudes are recorded at each distance:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake %>%\n  mutate(Distance_Category = factor(Distance_Category, \n                                     levels = c(\"Near\", \"Medium\", \"Far\", \"Very Far\"))) %>%\n  ggplot(aes(x = Distance_Category, y = Magnitude, fill = Distance_Category)) +\n  geom_boxplot(alpha = 0.7) +\n  geom_jitter(width = 0.2, alpha = 0.3, size = 1) +\n  labs(\n    title = \"Magnitude Range by Distance from Epicenter\",\n    x = \"Distance Category\",\n    y = \"Magnitude (Richter Scale)\",\n    fill = \"Distance\"\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\", size = 14),\n        legend.position = \"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 6463 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 6463 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Magnitude distribution across distance categories](03-exploratory_files/figure-html/fig-mag-by-distance-1.png){#fig-mag-by-distance width=960}\n:::\n:::\n\n\n**Finding:** The \"Near\" category may contain observations from smaller, foreshocks or aftershocks with lower magnitudes, while \"Far\" distances might have captured only the main shock (magnitude 8+). This explains the intensity difference.\n\n## Intensity by Magnitude and Distance\n\nLet's examine intensity by both magnitude AND distance to see the true relationship:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmagnitude_intensity <- earthquake %>%\n  filter(!is.na(Intensity)) %>%\n  mutate(Magnitude_Group = cut(Magnitude, \n                               breaks = c(0, 7, 8, 9),\n                               labels = c(\"M < 7\", \"M 7-8\", \"M > 8\"))) %>%\n  group_by(Distance_Category, Magnitude_Group) %>%\n  summarise(\n    Mean_Intensity = mean(Intensity, na.rm = TRUE),\n    Count = n(),\n    .groups = \"drop\"\n  ) %>%\n  mutate(Distance_Category = factor(Distance_Category, \n                                     levels = c(\"Near\", \"Medium\", \"Far\", \"Very Far\")))\n\nkable(magnitude_intensity, \n      caption = \"Average Intensity by Distance AND Magnitude Group\",\n      digits = 2)\n```\n\n::: {.cell-output-display}\n\n\nTable: Average Intensity by Distance AND Magnitude Group\n\n|Distance_Category |Magnitude_Group | Mean_Intensity| Count|\n|:-----------------|:---------------|--------------:|-----:|\n|Far               |M < 7           |           4.00|  5775|\n|Far               |M 7-8           |           4.02|  8775|\n|Far               |M > 8           |           3.33|     9|\n|Far               |NA              |           3.40|  1699|\n|Medium            |M < 7           |           4.03|  7155|\n|Medium            |M 7-8           |           4.08| 14635|\n|Medium            |M > 8           |           2.60|     5|\n|Medium            |NA              |           3.38|  3312|\n|Near              |M < 7           |           4.08|  9812|\n|Near              |M 7-8           |           4.01| 24283|\n|Near              |M > 8           |           2.20|     5|\n|Near              |NA              |           3.14|  7147|\n|Very Far          |M < 7           |           3.77| 17495|\n|Very Far          |M 7-8           |           3.95| 13012|\n|Very Far          |M > 8           |           2.43|     7|\n|Very Far          |NA              |           3.41|  3374|\n\n\n:::\n:::\n\n\n**Key Insight:** When we control for magnitude, the pattern becomes clearer. For similar magnitude earthquakes, intensity DOES decrease with distance, confirming seismic wave attenuation. The apparent anomaly was due to different magnitude distributions at different distances.\n\n## Data Composition by Distance\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistance_composition <- earthquake %>%\n  mutate(Distance_Category = factor(Distance_Category, \n                                     levels = c(\"Near\", \"Medium\", \"Far\", \"Very Far\"))) %>%\n  group_by(Distance_Category) %>%\n  summarise(\n    Count = n(),\n    Mean_Magnitude = round(mean(Magnitude, na.rm = TRUE), 2),\n    Mean_Intensity = round(mean(Intensity, na.rm = TRUE), 2),\n    .groups = \"drop\"\n  )\n\nkable(distance_composition,\n      caption = \"Data Distribution and Characteristics by Distance\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Data Distribution and Characteristics by Distance\n\n|Distance_Category | Count| Mean_Magnitude| Mean_Intensity|\n|:-----------------|-----:|--------------:|--------------:|\n|Near              | 44406|           7.70|           3.88|\n|Medium            | 30868|           7.57|           3.97|\n|Far               | 21107|           7.40|           3.95|\n|Very Far          | 45702|           7.03|           3.80|\n\n\n:::\n:::\n\n\n**Explanation:** The Near category has 44406 observations with mean magnitude 7.7, while Far has more observations with higher average magnitude. This is why the intensity patterns appear different—we're comparing different types of seismic events.\n\n---\n\n# Summary Table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_table <- tibble(\n  Variable = c(\"Magnitude\", \"Distance (km)\", \"Intensity\"),\n  Mean = c(\n    round(mean(earthquake$Magnitude, na.rm = TRUE), 2),\n    round(mean(earthquake$Distance_km, na.rm = TRUE), 1),\n    round(mean(earthquake$Intensity, na.rm = TRUE), 2)\n  ),\n  Min = c(\n    min(earthquake$Magnitude, na.rm = TRUE),\n    round(min(earthquake$Distance_km, na.rm = TRUE), 1),\n    min(earthquake$Intensity, na.rm = TRUE)\n  ),\n  Max = c(\n    max(earthquake$Magnitude, na.rm = TRUE),\n    round(max(earthquake$Distance_km, na.rm = TRUE), 1),\n    max(earthquake$Intensity, na.rm = TRUE)\n  )\n)\n\nkable(summary_table, caption = \"Summary Statistics\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Summary Statistics\n\n|Variable      |   Mean| Min|  Max|\n|:-------------|------:|---:|----:|\n|Magnitude     |   7.41|   4|   11|\n|Distance (km) | 145.30|   0| 9930|\n|Intensity     |   3.88|   1|   12|\n\n\n:::\n:::\n\n\n---\n\n**Next:** Go to [Correlation Analysis](04-correlations.qmd)\n",
    "supporting": [
      "03-exploratory_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}