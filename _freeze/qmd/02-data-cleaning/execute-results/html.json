{
  "hash": "4ee9ab691a2b57d5642570f9ba9d54e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Cleaning\"\nauthor: \"Your Name\"\ndate: today\nformat:\n  html:\n    code-fold: false\n    toc: true\n---\n\n# Introduction\n\nNow I'll clean the data to prepare it for analysis.\n\n## Load Libraries\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyverse' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tibble' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'purrr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dplyr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'stringr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'forcats' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lubridate' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.6.0\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(lubridate)\nlibrary(knitr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'knitr' was built under R version 4.5.2\n```\n\n\n:::\n:::\n\n\n## Load Raw Data\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake_raw <- readRDS(\"../data/processed/earthquake_raw.rds\")\n```\n:::\n\n\n## Remove Empty Columns\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake <- earthquake_raw %>%\n  select(-starts_with(\"Empty\"))\n\ncat(\"✓ Removed empty columns\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Removed empty columns\n```\n\n\n:::\n:::\n\n\n## Convert Data Types\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake <- earthquake %>%\n  mutate(\n    # Convert to numbers\n    Year = as.integer(Year),\n    Month = as.integer(Month),\n    Day = as.integer(Day),\n    Hour = as.integer(Hour),\n    Minute = as.integer(Minute),\n    Second = as.integer(Second),\n    Magnitude = as.numeric(Magnitude),\n    Epicenter_Lat = as.numeric(Epicenter_Lat),\n    Epicenter_Lon = as.numeric(Epicenter_Lon),\n    Distance_km = as.numeric(Distance_km),\n    Intensity = as.integer(Intensity)\n  )\n\ncat(\"✓ Converted data types\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Converted data types\n```\n\n\n:::\n:::\n\n\n## Create DateTime Column\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake <- earthquake %>%\n  mutate(\n    DateTime = make_datetime(Year, Month, Day, Hour, Minute, Second)\n  )\n\ncat(\"✓ Created DateTime column\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Created DateTime column\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Date range:\", format(min(earthquake$DateTime)), \"to\", format(max(earthquake$DateTime)), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDate range: NA to NA \n```\n\n\n:::\n:::\n\n\n## Remove Missing Values\n\n::: {.cell}\n\n```{.r .cell-code}\n# Before\ncat(\"Rows before:\", nrow(earthquake), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows before: 157015 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Remove rows without coordinates\nearthquake <- earthquake %>%\n  filter(!is.na(Epicenter_Lat) & !is.na(Epicenter_Lon))\n\n# After\ncat(\"Rows after:\", nrow(earthquake), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows after: 142083 \n```\n\n\n:::\n:::\n\n\n## Add Categories\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake <- earthquake %>%\n  mutate(\n    # Distance categories\n    Distance_Category = case_when(\n      Distance_km < 50 ~ \"Near\",\n      Distance_km < 100 ~ \"Medium\",\n      Distance_km < 150 ~ \"Far\",\n      TRUE ~ \"Very Far\"\n    )\n  )\n\ncat(\"✓ Added distance categories\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Added distance categories\n```\n\n\n:::\n:::\n\n\n## Check the Cleaned Data\n\n::: {.cell}\n\n```{.r .cell-code}\n# Preview\nhead(earthquake) %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n| Year| Month| Day| Hour| Minute| Second| Magnitude| Epicenter_Lat| Epicenter_Lon| Distance_km| Station_Lat| Station_Lon| Intensity|State |Location        |Quality |Country |DateTime |Distance_Category |\n|----:|-----:|---:|----:|------:|------:|---------:|-------------:|-------------:|-----------:|-----------:|-----------:|---------:|:-----|:---------------|:-------|:-------|:--------|:-----------------|\n| 1852|    11|  27|   NA|     NA|     NA|         8|          34.5|        -119.0|           0|       34.50|     -119.00|         7|CA    |LOCKWOOD VALLEY |H       |USA     |NA       |Near              |\n| 1852|    11|  27|   NA|     NA|     NA|         8|          34.5|        -119.0|         258|       33.02|     -116.84|         6|CA    |SAN DIEGO       |H       |USA     |NA       |Very Far          |\n| 1852|    11|  27|   NA|     NA|     NA|         8|          34.5|        -119.0|         159|       35.35|     -120.41|         6|CA    |SAN LUIS OBISPO |H       |USA     |NA       |Very Far          |\n| 1852|    11|  27|   NA|     NA|     NA|         8|          34.5|        -119.0|          NA|          NA|          NA|         6|CA    |COLORADO RIVER  |H       |USA     |NA       |Very Far          |\n| 1860|    11|  12|   NA|     NA|     NA|         8|          41.0|        -124.0|          32|       40.76|     -124.22|         8|CA    |HUMBOLDT BAY    |H       |USA     |NA       |Near              |\n| 1897|    11|  14|   NA|     NA|     NA|         7|          42.9|        -106.3|           7|       42.83|     -106.32|         7|WY    |CASPER          |H       |USA     |NA       |Near              |\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Summary\ncat(\"\\nCleaned Data Summary:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCleaned Data Summary:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Total observations:\", nrow(earthquake), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTotal observations: 142083 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"States:\", paste(unique(earthquake$State), collapse = \", \"), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStates: CA, WY, CO, AK, WA, NV, IN, SC, GA, NY, MO, TN, MS, KY, IL, AR, NC, TX, MD, ME, NB, QC, NS, CT, OR, UT, SD, MA, RI, ON, AL, BC, MXBC, AZ, OH, IA, VA, DC, KS, NH, PA, DE, WV, FL, VT, HI, OK, NM, MI, WI, NJ, MT, NE, ID, LA, PR, VI, ND, MXSO, YT, NA, MXME, MN, SK, AB, MB, NL \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Magnitude range:\", min(earthquake$Magnitude, na.rm = TRUE), \n    \"to\", max(earthquake$Magnitude, na.rm = TRUE), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMagnitude range: 4 to 11 \n```\n\n\n:::\n:::\n\n\n## Create Output Directory\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the directory if it doesn't exist\ndir.create(\"../data/processed\", recursive = TRUE, showWarnings = FALSE)\n\ncat(\"✓ Output directory ready\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Output directory ready\n```\n\n\n:::\n:::\n\n\n## Save Cleaned Data\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save as RDS\nsaveRDS(earthquake, \"../data/processed/earthquake_clean.rds\")\n\n# Also save as CSV\nwrite_csv(earthquake, \"../data/processed/earthquake_clean.csv\")\n\ncat(\"✓ Cleaned data saved!\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Cleaned data saved!\n```\n\n\n:::\n:::\n\n\n---\n\n**Next:** Go to [Exploratory Analysis](03-exploratory.qmd) →",
    "supporting": [
      "02-data-cleaning_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}