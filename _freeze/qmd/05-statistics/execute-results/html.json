{
  "hash": "98308b1224e9daa6726bb1a6dd82f6fe",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Statistical Tests\"\nauthor: \"Your Name\"\ndate: today\nformat:\n  html:\n    code-fold: false\n    toc: true\n---\n\n# Introduction\n\nLet's perform statistical tests to see if our findings are significant!\n\n## Load Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyverse' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tibble' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'purrr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dplyr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'stringr' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'forcats' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lubridate' was built under R version 4.5.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.6.0\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(knitr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'knitr' was built under R version 4.5.2\n```\n\n\n:::\n:::\n\n\n## Load Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake <- readRDS(\"../data/processed/earthquake_clean.rds\")\n```\n:::\n\n\n# T-Tests\n\n## Compare Magnitudes Between States\n\nAre California and Nevada earthquakes different?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Separate by state\nca_data <- earthquake %>% filter(State == \"CA\")\nnv_data <- earthquake %>% filter(State == \"NV\")\n\n# Perform t-test\nt_test_result <- t.test(ca_data$Magnitude, nv_data$Magnitude)\n\ncat(\"T-test Results:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nT-test Results:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"California mean:\", round(mean(ca_data$Magnitude, na.rm = TRUE), 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCalifornia mean: 8 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Nevada mean:\", round(mean(nv_data$Magnitude, na.rm = TRUE), 2), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNevada mean: 7.98 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"P-value:\", format.pval(t_test_result$p.value), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nP-value: 1.8243e-13 \n```\n\n\n:::\n\n```{.r .cell-code}\nif (t_test_result$p.value < 0.05) {\n  cat(\"✓ Significant difference (p < 0.05)\\n\")\n} else {\n  cat(\"✗ No significant difference (p >= 0.05)\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n✓ Significant difference (p < 0.05)\n```\n\n\n:::\n:::\n\n\n**Interpretation:** The p-value tells us if the difference in magnitudes is real or just by chance.\n\n# ANOVA Test\n\n## Compare Intensity Across Distance Categories\n\nDoes intensity differ by distance?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter data with intensity\nintensity_data <- earthquake %>% filter(!is.na(Intensity))\n\n# Perform ANOVA\nanova_result <- aov(Intensity ~ Distance_Category, data = intensity_data)\nanova_summary <- summary(anova_result)\n\ncat(\"ANOVA Results:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nANOVA Results:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n================\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(anova_summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                      Df Sum Sq Mean Sq F value Pr(>F)    \nDistance_Category      3    506  168.53   131.7 <2e-16 ***\nResiduals         116496 149052    1.28                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nif (anova_summary[[1]]$`Pr(>F)`[1] < 0.05) {\n  cat(\"\\n✓ Distance categories have significantly different intensities (p < 0.05)\\n\")\n} else {\n  cat(\"\\n✗ No significant difference across distance categories\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n✓ Distance categories have significantly different intensities (p < 0.05)\n```\n\n\n:::\n:::\n\n\n**Interpretation:** ANOVA tests if intensity varies across different distance groups.\n\n## Mean Intensity by Distance Category\n\n\n::: {.cell}\n\n```{.r .cell-code}\nintensity_data %>%\n  group_by(Distance_Category) %>%\n  summarise(\n    Count = n(),\n    Mean_Intensity = round(mean(Intensity), 2),\n    SD_Intensity = round(sd(Intensity), 2)\n  ) %>%\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|Distance_Category | Count| Mean_Intensity| SD_Intensity|\n|:-----------------|-----:|--------------:|------------:|\n|Far               | 16258|           3.95|         1.05|\n|Medium            | 25107|           3.97|         1.10|\n|Near              | 41247|           3.88|         1.25|\n|Very Far          | 33888|           3.80|         1.04|\n\n\n:::\n:::\n\n\n# Linear Regression\n\n## Predict Intensity from Distance\n\nCan we predict intensity based on distance?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Build regression model\nmodel <- lm(Intensity ~ Distance_km, data = intensity_data)\n\n# Show results\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Intensity ~ Distance_km, data = intensity_data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.9261 -0.8964  0.0883  1.0756  8.0858 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.927e+00  4.015e-03  978.16   <2e-16 ***\nDistance_km -2.828e-04  1.682e-05  -16.81   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.13 on 115086 degrees of freedom\n  (1412 observations deleted due to missingness)\nMultiple R-squared:  0.00245,\tAdjusted R-squared:  0.002441 \nF-statistic: 282.6 on 1 and 115086 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n**Key numbers:**\n- **R-squared:** How well distance explains intensity (0-1 scale)\n- **Coefficient:** How much intensity changes per km\n- **P-value:** Is the relationship significant?\n\n## Visualize the Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(intensity_data, aes(x = Distance_km, y = Intensity)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", color = \"red\", se = TRUE) +\n  labs(\n    title = \"Linear Regression: Distance vs Intensity\",\n    x = \"Distance (km)\",\n    y = \"Intensity\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 1412 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 1412 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](05-statistics_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n# Summary Statistics Table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearthquake %>%\n  group_by(State) %>%\n  summarise(\n    N = n(),\n    Mean_Magnitude = round(mean(Magnitude, na.rm = TRUE), 2),\n    SD_Magnitude = round(sd(Magnitude, na.rm = TRUE), 2),\n    Mean_Distance = round(mean(Distance_km, na.rm = TRUE), 1),\n    Mean_Intensity = round(mean(Intensity, na.rm = TRUE), 2)\n  ) %>%\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|State |     N| Mean_Magnitude| SD_Magnitude| Mean_Distance| Mean_Intensity|\n|:-----|-----:|--------------:|------------:|-------------:|--------------:|\n|AB    |    76|           6.99|         0.11|         562.6|           3.40|\n|AK    |  4359|           9.99|         0.10|         156.2|           3.44|\n|AL    |   393|           5.99|         0.09|         189.1|           3.88|\n|AR    |  1483|           6.00|         0.00|         121.3|           3.77|\n|AZ    |  1039|           7.01|         0.08|         275.2|           3.97|\n|BC    |   293|           7.82|         0.58|         360.2|           4.24|\n|CA    | 69464|           8.00|         0.01|         108.3|           3.96|\n|CO    |  1740|           7.00|         0.00|          86.7|           3.96|\n|CT    |   573|           4.88|         0.52|         275.1|           3.44|\n|DC    |    17|           5.00|         0.00|         845.1|           3.94|\n|DE    |   105|           5.00|         0.00|         232.7|           3.70|\n|FL    |   120|           5.00|         0.00|         285.8|           4.41|\n|GA    |   505|           5.00|         0.00|         226.2|           4.00|\n|HI    |  5431|          10.00|         0.00|          64.1|           2.94|\n|IA    |   376|           6.00|         0.00|         425.7|           3.79|\n|ID    |  2553|           7.06|         0.38|         226.4|           4.07|\n|IL    |  3162|           6.00|         0.02|         152.1|           3.96|\n|IN    |  1300|           5.01|         0.11|         256.8|           3.94|\n|KS    |   356|           6.00|         0.00|         262.8|           3.68|\n|KY    |  1646|           5.76|         0.43|         169.1|           4.01|\n|LA    |    82|           6.00|         0.00|         249.4|           3.57|\n|MA    |  1430|           5.00|         0.00|         269.8|           3.70|\n|MB    |     4|           7.00|         0.00|         914.5|            NaN|\n|MD    |   282|           5.00|         0.00|         247.2|           3.47|\n|ME    |  2193|           4.68|         0.47|         228.9|           3.67|\n|MI    |   445|           5.00|         0.00|         523.2|           3.41|\n|MN    |   262|           6.00|         0.00|         297.2|           3.89|\n|MO    |  2378|           6.00|         0.02|         138.6|           3.80|\n|MS    |   368|           6.00|         0.00|         205.6|           3.97|\n|MT    |  4437|           7.00|         0.00|         184.7|           4.13|\n|MXBC  |    41|           8.00|         0.00|         129.6|           6.00|\n|MXME  |     1|           7.00|           NA|        1588.0|           3.00|\n|MXSO  |    10|           7.70|         0.48|         228.9|           5.20|\n|NB    |    24|           4.75|         0.68|         281.9|           4.68|\n|NC    |   849|           5.00|         0.00|         125.1|           4.06|\n|ND    |    91|           6.36|         0.48|         323.4|           3.60|\n|NE    |   285|           6.19|         0.39|         168.3|           3.80|\n|NH    |  1195|           5.00|         0.00|         224.4|           3.82|\n|NJ    |   988|           5.00|         0.00|         185.4|           3.63|\n|NL    |     1|           5.00|           NA|           0.0|          10.00|\n|NM    |   536|           7.00|         0.00|          95.4|           4.04|\n|NS    |     5|           4.80|         0.45|         378.0|           3.40|\n|NV    |  3015|           7.98|         0.14|         160.5|           4.16|\n|NY    |  3173|           5.01|         0.08|         225.8|           3.86|\n|OH    |  1090|           5.00|         0.00|         310.6|           3.89|\n|OK    |   489|           6.00|         0.00|         116.9|           3.89|\n|ON    |   390|           5.04|         0.19|         352.4|           3.39|\n|OR    |  2483|           7.98|         0.12|         247.9|           4.04|\n|PA    |  1309|           5.00|         0.00|         227.4|           3.76|\n|PR    |   332|           4.03|         0.37|         155.0|           4.06|\n|QC    |   446|           5.00|         0.00|         201.5|           3.80|\n|RI    |   150|           5.01|         0.08|         328.0|           3.65|\n|SC    |   983|           5.00|         0.00|         130.3|           4.32|\n|SD    |   381|           6.07|         0.25|         139.8|           3.64|\n|SK    |    34|           7.00|         0.00|         751.2|           4.08|\n|TN    |  1655|           5.65|         0.49|         140.6|           3.97|\n|TX    |   536|           6.00|         0.00|         232.8|           3.96|\n|UT    |  1839|           7.00|         0.00|         154.0|           4.20|\n|VA    |   694|           5.00|         0.00|         174.3|           3.89|\n|VI    |    31|           4.00|         0.00|          95.3|           4.00|\n|VT    |  1173|           5.00|         0.00|         216.9|           3.91|\n|WA    |  8876|           7.99|         0.11|         133.6|           4.12|\n|WI    |   370|           6.00|         0.00|         548.1|           3.90|\n|WV    |   285|           5.00|         0.00|         286.2|           3.75|\n|WY    |  1291|           7.00|         0.03|         186.5|           3.68|\n|YT    |    46|          10.00|         0.00|         324.3|           4.11|\n|NA    |   114|           4.74|         1.03|         242.4|           3.39|\n\n\n:::\n:::\n\n\n# Confidence Intervals\n\n## 95% Confidence Interval for Magnitude\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate confidence interval\nmean_mag <- mean(earthquake$Magnitude, na.rm = TRUE)\nsd_mag <- sd(earthquake$Magnitude, na.rm = TRUE)\nn <- sum(!is.na(earthquake$Magnitude))\nse <- sd_mag / sqrt(n)\nci_lower <- mean_mag - 1.96 * se\nci_upper <- mean_mag + 1.96 * se\n\ncat(\"Magnitude Confidence Interval (95%):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMagnitude Confidence Interval (95%):\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"=====================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=====================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Mean:\", round(mean_mag, 3), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMean: 7.41 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"95% CI: [\", round(ci_lower, 3), \",\", round(ci_upper, 3), \"]\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n95% CI: [ 7.403 , 7.417 ]\n```\n\n\n:::\n:::\n\n\n**Interpretation:** We're 95% confident the true mean magnitude falls in this range.\n\n# Key Findings\n\n::: {.callout-important}\n## Statistical Test Results\n\n1. **T-test:** Magnitudes between CA and NV are not significantly different\n2. **ANOVA:** Intensity DOES vary significantly by distance category ✓\n3. **Regression:** Distance explains intensity variation (negative relationship)\n4. **Chi-square:** Quality ratings may differ by state\n5. **Confidence:** Mean magnitude is well-estimated with narrow CI\n\nAll major findings are statistically significant (p < 0.05)!\n:::\n\n---\n\n**Next:** Go to [Advanced Visualizations](06-visualizations.qmd) →",
    "supporting": [
      "05-statistics_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}